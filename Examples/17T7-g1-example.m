AttachSpec("spec");
SetDebugOnError(true);
QQ := Rationals();
R<x,y> := PolynomialRing(QQ,2);
F := x^3*y^17 + 19/128*x^3*y^16 + 31/4096*x^3*y^15 + 75/524288*x^3*y^14 - 153/4294967296*x^3*y^12 - 409/1099511627776*x^3*y^11 + 251/140737488355328*x^3*y^10 + 1885/36028797018963968*x^3*y^9 + 755/4611686018427387904*x^3*y^8 - 779/295147905179352825856*x^3*y^7 - 791/37778931862957161709568*x^3*y^6 + 57/2417851639229258349412352*x^3*y^5 + 15/19342813113834066795298816*x^3*y^4 + 165/79228162514264337593543950336*x^3*y^3 - 79/10141204801825835211973625643008*x^3*y^2 - 259/5192296858534827628530496329220096*x^3*y - 49/664613997892457936451903530140172288*x^3 + 1/2415919104*x^2*y^12 - 1/8589934592*x^2*y^11 + 1069/633318697598976*x^2*y^10 + 32005/972777519512027136*x^2*y^9 - 14065/124515522497539473408*x^2*y^8 - 8471/7968993439842526298112*x^2*y^7 + 2489/113336795588871485128704*x^2*y^6 + 3827/43521329506126650289422336*x^2*y^5 - 18955/16712190530352633711138177024*x^2*y^4 - 4225/713053462628379038341895553024*x^2*y^3 + 4291/273812529649297550723287892361216*x^2*y^2 + 10333/70096007590220172985161700444471296*x^2*y + 2243/8972288971548182142100697656892325888*x^2 + 1/17509995351216488448*x*y^7 - 53/17930235239645684170752*x*y^6 - 151/4590140221349295147712512*x*y^5 + 3985/14100910759985034693772836864*x*y^4 + 11305/3609833154556168881605846237184*x*y^3 - 10243/1232156383421838978254795515625472*x*y^2 - 506803/3785184409871889341198731824001449984*x*y - 46931/161501201487867278557812557824061865984*x + 1/380724590519595936731866595328*y^2 + 53/1559447922768264956853725574463488*y + 23/199609334114337914477276873531326464;

// integralize
/*
cs, mons := CoefficientsAndMonomials(F);
dens := [Denominator(el) : el in cs];
printf "F = %o\n\n", F;
F_old := F;
F := LCM(dens)*F;
printf "integralized F = %o\n", F;
*/

F_padic := reducemodel_padic(F);
F_unit := reducemodel_units(F_padic);
